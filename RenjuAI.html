<html>
<body background="Background.png"></body>
<a href="Passage00.html">返回主页</a>
<hr>
<canvas id="mycanvas" width="900px" height="900px"></canvas><br>
版本：V1.2<br>
<button onclick="newgame()">新局</button>
<button onclick="retract()">悔棋</button>
<button onclick="deeping()">计算</button>
<div><select id="selMoveList" size="10" style="font-family:宋体" onchange="moveList_change()"">
<option selected value=0>======== 开始 ========</option>
<script>
var chess = document.getElementById("mycanvas")
var context = chess.getContext("2d")
var me = true
var chessBox = []
var l=[]
var black=[]
var white=[]
var color=['白','黑']
var letter=['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O']
var number=['1','2','3','4','5','6','7','8','9','10','11','12','13','14','15']
for(var i=0;i<225;i++){
  chessBox[i]=0
 }
 function same(x,y){return JSON.stringify(x.slice(0).sort())==JSON.stringify(y.slice(0).sort())}
 function onesame(x,y){var q=false;for(i=0;i<y.length;i++){if(x.includes(y[i])){var q=true;break}};return q}
function name(i){return letter[Math.floor(i/15)]+number[i%15]}
function value(color){
  l61 = 0;
	 l62 = 0;
	 l51 = 0;
	 l52 = 0;
	 l41 = 0;
	 l42 = 0;
	 cs41 = 0;
	 cs42 = 0;
	 sjs41 = 0;
	 sjs42 = 0;
	 mjs41 = 0;
	 mjs42 = 0;
	 cl31 = 0;
	 cl32 = 0;
	 jl31 = 0;
	 jl32 = 0;
	 cs31 = 0;
	 cs32 = 0;
	 js31 = 0;
	 js32 = 0;
	 bjs31 = 0;
	 bjs32 = 0;
	 jjs31 = 0;
	 jjs32 = 0;
	 cl21 = 0;
	 cl22 = 0;
	 jl21 = 0;
	 jl22 = 0;
	 bjl21 = 0;
	 bjl22 = 0;
	 cs21 = 0;
	 cs22 = 0;
	 js21=0;
	 js22=0;
	 l11 = 0;
	 l12 = 0;
	 s11 = 0;
	 s12 = 0;
	 score1 = 0;
	 score2 = 0;
  for(var i=0;i<l.length;i++){
      x=Math.floor(l[i]/15);y=l[i]%15
    l0 = [ -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1 ];
		l1 = [ -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1 ];
		l2 = [ -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1 ];
		l3= [ -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1 ];
		for (var k = 0; k < 11; k++) {
			if (0 <= x - 5 + k && x - 5 + k < 15) {
				l0[k] = chessBox[15*(x - 5+k) + y];
			}
			if (0 <= x - 5 + k && x - 5 + k < 15 && 0 <= y - 5 + k && y - 5 + k < 15) {
				l1[k] = chessBox[15*(x - 5 + k)+y - 5 + k];
			}
			if (0 <= y - 5 + k && y - 5 + k < 15) {
				l2[k] = chessBox[15*x+y - 5 + k];
			}
			if (0 <= x + 5 - k && x + 5 - k < 15 && 0 <= y - 5 + k && y- 5 + k < 15) {
				l3[k] = chessBox[15*(x + 5 - k)+y - 5 + k];
			}
		}
    for ( var k = 0; k < 6; k++) {
		if (k != 5 && l0[k + 1] == 1 && l0[k + 2] == 1 && l0[k + 3] == 1 && l0[k + 4] == 1 && l0[k + 5] == 1 && l0[k] == 1) { l61 += 1; }
				if (k != 5 && l1[k + 1] == 1 && l1[k + 2] == 1 && l1[k + 3] == 1 && l1[k + 4] == 1 && l1[k + 5] == 1 && l1[k] == 1) { l61 += 1; }
				if (k != 5 && l2[k + 1] == 1 && l2[k + 2] == 1 && l2[k + 3] == 1 && l2[k + 4] == 1 && l2[k + 5] == 1 && l2[k] == 1) { l61 += 1; }
				if (k != 5 && l3[k + 1] == 1 && l3[k + 2] == 1 && l3[k + 3] == 1 && l3[k + 4] == 1 && l3[k + 5] == 1 && l3[k] == 1) { l61 += 1; }
				if (k != 5 && l0[k + 1] == 1 && l0[k + 2] == 1 && l0[k + 3] == 1 && l0[k + 4] == 1 && l0[k + 5] == 1 && l0[k] != 1 && l0[k + 6] != 1) { l51 += 1; }
				if (k != 5 && l1[k + 1] == 1 && l1[k + 2] == 1 && l1[k + 3] == 1 && l1[k + 4] == 1 && l1[k + 5] == 1 && l1[k] != 1 && l1[k + 6] != 1) { l51 += 1; }
				if (k != 5 && l2[k + 1] == 1 && l2[k + 2] == 1 && l2[k + 3] == 1 && l2[k + 4] == 1 && l2[k + 5] == 1 && l2[k] != 1 && l2[k + 6] != 1) { l51 += 1; }
				if (k != 5 && l3[k + 1] == 1 && l3[k + 2] == 1 && l3[k + 3] == 1 && l3[k + 4] == 1 && l3[k + 5] == 1 && l3[k] != 1 && l3[k + 6] != 1) { l51 += 1; }
				if (k != 5 && l0[k + 1] == 2 && l0[k + 2] == 2 && l0[k + 3] == 2 && l0[k + 4] == 2 && l0[k + 5] == 2 && l0[k] == 2) { l62 += 1; }
				if (k != 5 && l1[k + 1] == 2 && l1[k + 2] == 2 && l1[k + 3] == 2 && l1[k + 4] == 2 && l1[k + 5] == 2 && l1[k] == 2) { l62 += 1; }
				if (k != 5 && l2[k + 1] == 2 && l2[k + 2] == 2 && l2[k + 3] == 2 && l2[k + 4] == 2 && l2[k + 5] == 2 && l2[k] == 2) { l62 += 1; }
				if (k != 5 && l3[k + 1] == 2 && l3[k + 2] == 2 && l3[k + 3] == 2 && l3[k + 4] == 2 && l3[k + 5] == 2 && l3[k] == 2) { l62 += 1; }
				if (k != 5 && l0[k + 1] == 2 && l0[k + 2] == 2 && l0[k + 3] == 2 && l0[k + 4] == 2 && l0[k + 5] == 2 && l0[k] != 2 && l0[k + 6] != 2) { l52 += 1; }
				if (k != 5 && l1[k + 1] == 2 && l1[k + 2] == 2 && l1[k + 3] == 2 && l1[k + 4] == 2 && l1[k + 5] == 2 && l1[k] != 2 && l1[k + 6] != 2) { l52 += 1; }
				if (k != 5 && l2[k + 1] == 2 && l2[k + 2] == 2 && l2[k + 3] == 2 && l2[k + 4] == 2 && l2[k + 5] == 2 && l2[k] != 2 && l2[k + 6] != 2) { l52 += 1; }
				if (k != 5 && l3[k + 1] == 2 && l3[k + 2] == 2 && l3[k + 3] == 2 && l3[k + 4] == 2 && l3[k + 5] == 2 && l3[k] != 2 && l3[k + 6] != 2) { l52 += 1; }
				if (k != 4 && k != 5 && l0[k + 1] != 1 && l0[k + 2] == 1 && l0[k + 3] == 1 && l0[k + 4] == 1 && l0[k + 5] == 1 && l0[k + 6] != 1) {
					t = 0; if (l0[k + 1] != 0 || l0[k + 0] == 1) { t += 1; }; if (l0[k + 6] != 0 || l0[k + 7] == 1) { t += 1; }; if (t == 0) { l41 += 1; }; if (t == 1) { cs41 += 1; }
				}
				if (k != 4 && k != 5 && l1[k + 1] != 1 && l1[k + 2] == 1 && l1[k + 3] == 1 && l1[k + 4] == 1 && l1[k + 5] == 1 && l1[k + 6] != 1) {
					t = 0; if (l1[k + 1] != 0 || l1[k + 0] == 1) { t += 1; }; if (l1[k + 6] != 0 || l1[k + 7] == 1) { t += 1; }; if (t == 0) { l41 += 1; }; if (t == 1) { cs41 += 1; }
				}
				if (k != 4 && k != 5 && l2[k + 1] != 1 && l2[k + 2] == 1 && l2[k + 3] == 1 && l2[k + 4] == 1 && l2[k + 5] == 1 && l2[k + 6] != 1) {
					t = 0; if (l2[k + 1] != 0 || l2[k + 0] == 1) { t += 1; }; if (l2[k + 6] != 0 || l2[k + 7] == 1) { t += 1; }; if (t == 0) { l41 += 1; }; if (t == 1) { cs41 += 1; }
				}
				if (k != 4 && k != 5 && l3[k + 1] != 1 && l3[k + 2] == 1 && l3[k + 3] == 1 && l3[k + 4] == 1 && l3[k + 5] == 1 && l3[k + 6] != 1) {
					 t = 0; if (l3[k + 1] != 0 || l3[k + 0] == 1) { t += 1; }; if (l3[k + 6] != 0 || l3[k + 7] == 1) { t += 1; }; if (t == 0) { l41 += 1; }; if (t == 1) { cs41 += 1; }
				}
				if (k != 4 && k != 5 && l0[k + 1] != 2 && l0[k + 2] == 2 && l0[k + 3] == 2 && l0[k + 4] == 2 && l0[k + 5] == 2 && l0[k + 6] != 2) {
					t = 0; if (l0[k + 1] != 0) { t += 1; }; if (l0[k + 6] != 0) { t += 1; }; if (t == 0) { l42 += 1; }; if (t == 1) { cs42 += 1; }
				}
				if (k != 4 && k != 5 && l1[k + 1] != 2 && l1[k + 2] == 2 && l1[k + 3] == 2 && l1[k + 4] == 2 && l1[k + 5] == 2 && l1[k + 6] != 2) {
					t = 0; if (l1[k + 1] != 0) { t += 1; }; if (l1[k + 6] != 0) { t += 1; }; if (t == 0) { l42 += 1; }; if (t == 1) { cs42 += 1; }
				}
				if (k != 4 && k != 5 && l2[k + 1] != 2 && l2[k + 2] == 2 && l2[k + 3] == 2 && l2[k + 4] == 2 && l2[k + 5] == 2 && l2[k + 6] != 2) {
					t = 0; if (l2[k + 1] != 0) { t += 1; }; if (l2[k + 6] != 0) { t += 1; }; if (t == 0) { l42 += 1; }; if (t == 1) { cs42 += 1; }
				}
				if (k != 4 && k != 5 && l3[k + 1] != 2 && l3[k + 2] == 2 && l3[k + 3] == 2 && l3[k + 4] == 2 && l3[k + 5] == 2 && l3[k + 6] != 2) {
					t = 0; if (l3[k + 1] != 0) { t += 1; }; if (l3[k + 6] != 0) { t += 1; }; if (t == 0) { l42 += 1; }; if (t == 1) { cs42 += 1; }
				}
				if (k != 1 && k != 5 && l0[k + 1] == 1 && l0[k + 2] == 1 && l0[k + 3] == 1 && l0[k + 5] == 1 && l0[k + 4] == 0 && l0[k] != 1 && l0[k + 6] != 1) { sjs41 += 1; }
				if (k != 3 && k != 5 && l0[k + 1] == 1 && l0[k + 3] == 1 && l0[k + 4] == 1 && l0[k + 5] == 1 && l0[k + 2] == 0 && l0[k] != 1 && l0[k + 6] != 1) { sjs41 += 1; }
				if (k != 2 && k != 5 && l0[k + 1] == 1 && l0[k + 2] == 1 && l0[k + 4] == 1 && l0[k + 5] == 1 && l0[k + 3] == 0 && l0[k] != 1 && l0[k + 6] != 1) { mjs41 += 1; }
				if (k != 1 && k != 5 && l1[k + 1] == 1 && l1[k + 2] == 1 && l1[k + 3] == 1 && l1[k + 5] == 1 && l1[k + 4] == 0 && l1[k] != 1 && l1[k + 6] != 1) { sjs41 += 1; }
				if (k != 3 && k != 5 && l1[k + 1] == 1 && l1[k + 3] == 1 && l1[k + 4] == 1 && l1[k + 5] == 1 && l1[k + 2] == 0 && l1[k] != 1 && l1[k + 6] != 1) { sjs41 += 1; }
				if (k != 2 && k != 5 && l1[k + 1] == 1 && l1[k + 2] == 1 && l1[k + 4] == 1 && l1[k + 5] == 1 && l1[k + 3] == 0 && l1[k] != 1 && l1[k + 6] != 1) { mjs41 += 1; }
				if (k != 1 && k != 5 && l2[k + 1] == 1 && l2[k + 2] == 1 && l2[k + 3] == 1 && l2[k + 5] == 1 && l2[k + 4] == 0 && l2[k] != 1 && l2[k + 6] != 1) { sjs41 += 1; }
				if (k != 3 && k != 5 && l2[k + 1] == 1 && l2[k + 3] == 1 && l2[k + 4] == 1 && l2[k + 5] == 1 && l2[k + 2] == 0 && l2[k] != 1 && l2[k + 6] != 1) { sjs41 += 1; }
				if (k != 2 && k != 5 && l2[k + 1] == 1 && l2[k + 2] == 1 && l2[k + 4] == 1 && l2[k + 5] == 1 && l2[k + 3] == 0 && l2[k] != 1 && l2[k + 6] != 1) { mjs41 += 1; }
				if (k != 1 && k != 5 && l3[k + 1] == 1 && l3[k + 2] == 1 && l3[k + 3] == 1 && l3[k + 5] == 1 && l3[k + 4] == 0 && l3[k] != 1 && l3[k + 6] != 1) { sjs41 += 1; }
				if (k != 3 && k != 5 && l3[k + 1] == 1 && l3[k + 3] == 1 && l3[k + 4] == 1 && l3[k + 5] == 1 && l3[k + 2] == 0 && l3[k] != 1 && l3[k + 6] != 1) { sjs41 += 1; }
				if (k != 2 && k != 5 && l3[k + 1] == 1 && l3[k + 2] == 1 && l3[k + 4] == 1 && l3[k + 5] == 1 && l3[k + 3] == 0 && l3[k] != 1 && l3[k + 6] != 1) { mjs41 += 1; }
				if (k != 2 && k != 5 && l0[k + 1] == 2 && l0[k + 2] == 2 && l0[k + 3] == 2 && l0[k + 5] == 2 && l0[k + 4] == 0) { sjs42 += 1; }
				if (k != 3 && k != 5 && l0[k + 1] == 2 && l0[k + 3] == 2 && l0[k + 4] == 2 && l0[k + 5] == 2 && l0[k + 2] == 0) { sjs42 += 1; }
				if (k != 2 && k != 5 && l0[k + 1] == 2 && l0[k + 2] == 2 && l0[k + 4] == 2 && l0[k + 5] == 2 && l0[k + 3] == 0) { mjs42 += 1; }
				if (k != 2 && k != 5 && l1[k + 1] == 2 && l1[k + 2] == 2 && l1[k + 3] == 2 && l1[k + 5] == 2 && l1[k + 4] == 0) { sjs42 += 1; }
				if (k != 3 && k != 5 && l1[k + 1] == 2 && l1[k + 3] == 2 && l1[k + 4] == 2 && l1[k + 5] == 2 && l1[k + 2] == 0) { sjs42 += 1; }
				if (k != 2 && k != 5 && l1[k + 1] == 2 && l1[k + 2] == 2 && l1[k + 4] == 2 && l1[k + 5] == 2 && l1[k + 3] == 0) { mjs42 += 1; }
				if (k != 2 && k != 5 && l2[k + 1] == 2 && l2[k + 2] == 2 && l2[k + 3] == 2 && l2[k + 5] == 2 && l2[k + 4] == 0) { sjs42 += 1; }
				if (k != 3 && k != 5 && l2[k + 1] == 2 && l2[k + 3] == 2 && l2[k + 4] == 2 && l2[k + 5] == 2 && l2[k + 2] == 0) { sjs42 += 1; }
				if (k != 2 && k != 5 && l2[k + 1] == 2 && l2[k + 2] == 2 && l2[k + 4] == 2 && l2[k + 5] == 2 && l2[k + 3] == 0) { mjs42 += 1; }
				if (k != 2 && k != 5 && l3[k + 1] == 2 && l3[k + 2] == 2 && l3[k + 3] == 2 && l3[k + 5] == 2 && l3[k + 4] == 0) { sjs42 += 1; }
				if (k != 3 && k != 5 && l3[k + 1] == 2 && l3[k + 3] == 2 && l3[k + 4] == 2 && l3[k + 5] == 2 && l3[k + 2] == 0) { sjs42 += 1; }
				if (k != 2 && k != 5 && l3[k + 1] == 2 && l3[k + 2] == 2 && l3[k + 4] == 2 && l3[k + 5] == 2 && l3[k + 3] == 0) { mjs42 += 1; }
				if (k != 3 && k != 4 && k != 5 && l0[k + 3] == 1 && l0[k + 4] == 1 && l0[k + 5] == 1 && l0[k + 2] != 1 && l0[k + 6] != 1 && (l0[k + 1] != 1 || (l0[k + 2] != 0 && l0[k + 2] != 1)) && (l0[k + 7] != 1 || (l0[k + 6] != 0 && l0[k + 6] != 1))) {
					t = 0; u = 0;
					if (l0[k + 2] != 0 || l0[k + 1] == 1) { t += 1; }
					else if (l0[k + 1] != 0 && l0[k + 1] != 1 || l0[k] == 1) { u += 1; }
					if (l0[k + 6] != 0 || l0[k + 7] == 1) { t += 1; }
					else if (l0[k + 7] != 0 && l0[k + 7] != 1 || l0[k + 8] == 1) { u += 1; }
					if (t == 0 && u <= 1) { cl31 += 1; }
					if ((t == 0 && u == 2) || (t == 1 && u == 0)) { cs31 += 1; }
				}
				if (k != 3 && k != 4 && k != 5 && l1[k + 3] == 1 && l1[k + 4] == 1 && l1[k + 5] == 1 && l1[k + 2] != 1 && l1[k + 6] != 1 && (l1[k + 1] != 1 || (l1[k + 2] != 0 && l1[k + 2] != 1)) && (l1[k + 7] != 1 || (l1[k + 6] != 0 && l1[k + 6] != 1))) {
					t = 0; u = 0;
					if (l1[k + 2] != 0 || l1[k + 1] == 1) { t += 1; }
					else if (l1[k + 1] != 0 && l1[k + 1] != 1 || l1[k] == 1) { u += 1; }
					if (l1[k + 6] != 0 || l1[k + 7] == 1) { t += 1; }
					else if (l1[k + 7] != 0 && l1[k + 7] != 1 || l1[k + 8] == 1) { u += 1; }
					if (t == 0 && u <= 1) { cl31 += 1; }
					if ((t == 0 && u == 2) || (t == 1 && u == 0)) { cs31 += 1; }
				}
				if (k != 3 && k != 4 && k != 5 && l2[k + 3] == 1 && l2[k + 4] == 1 && l2[k + 5] == 1 && l2[k + 2] != 1 && l2[k + 6] != 1 && (l2[k + 1] != 1 || (l2[k + 2] != 0 && l2[k + 2] != 1)) && (l2[k + 7] != 1 || (l2[k + 6] != 0 && l2[k + 6] != 1))) {
					t = 0; u = 0;
					if (l2[k + 2] != 0 || l2[k + 1] == 1) { t += 1; }
					else if (l2[k + 1] != 0 && l2[k + 1] != 1 || l2[k] == 1) { u += 1; }
					if (l2[k + 6] != 0 || l2[k + 7] == 1) { t += 1; }
					else if (l2[k + 7] != 0 && l2[k + 7] != 1 || l2[k + 8] == 1) { u += 1; }
					if (t == 0 && u <= 1) { cl31 += 1; }
					if ((t == 0 && u == 2) || (t == 1 && u == 0)) { cs31 += 1; }
				}
				if (k != 3 && k != 4 && k != 5 && l3[k + 3] == 1 && l3[k + 4] == 1 && l3[k + 5] == 1 && l3[k + 2] != 1 && l3[k + 6] != 1 && (l3[k + 1] != 1 || (l3[k + 2] != 0 && l3[k + 2] != 1)) && (l3[k + 7] != 1 || (l3[k + 6] != 0 && l3[k + 6] != 1))) {
					t = 0; u = 0;
					if (l3[k + 2] != 0 || l3[k + 1] == 1) { t += 1; }
					else if (l3[k + 1] != 0 && l3[k + 1] != 1 || l3[k] == 1) { u += 1; }
					if (l3[k + 6] != 0 || l3[k + 7] == 1) { t += 1; }
					else if (l3[k + 7] != 0 && l3[k + 7] != 1 || l3[k + 8] == 1) { u += 1; }
					if (t == 0 && u <= 1) { cl31 += 1; }
					if ((t == 0 && u == 2) || (t == 1 && u == 0)) { cs31 += 1; }
				}
				if (k != 3 && k != 4 && k != 5 && l0[k + 3] == 2 && l0[k + 4] == 2 && l0[k + 5] == 2 && l0[k + 2] != 2 && l0[k + 6] != 2 && (l0[k + 1] != 2 || (l0[k + 2] != 0 && l0[k + 2] != 2)) && (l0[k + 7] != 2 || (l0[k + 6] != 0 && l0[k + 6] != 2))) {
					t = 0; u = 0;
					if (l0[k + 2] != 0) { t += 1; }
					else if (l0[k + 1] != 0 && l0[k + 1] != 2) { u += 1; }
					if (l0[k + 6] != 0) { t += 1; }
					else if (l0[k + 7] != 0 && l0[k + 7] != 2) { u += 1; }
					if (t == 0 && u <= 1) { cl32 += 1; }
					if ((t == 0 && u == 2) || (t == 1 && u == 0)) { cs32 += 1; }
				}
				if (k != 3 && k != 4 && k != 5 && l1[k + 3] == 2 && l1[k + 4] == 2 && l1[k + 5] == 2 && l1[k + 2] != 2 && l1[k + 6] != 2 && (l1[k + 1] != 2 || (l1[k + 2] != 0 && l1[k + 2] != 2)) && (l1[k + 7] != 2 || (l1[k + 6] != 0 && l1[k + 6] != 2))) {
					t = 0; u = 0;
					if (l1[k + 2] != 0) { t += 1; }
					else if (l1[k + 1] != 0 && l1[k + 1] != 2) { u += 1; }
					if (l1[k + 6] != 0) { t += 1; }
					else if (l1[k + 7] != 0 && l1[k + 7] != 2) { u += 1; }
					if (t == 0 && u <= 1) { cl32 += 1; }
					if ((t == 0 && u == 2) || (t == 1 && u == 0)) { cs32 += 1; }
				}
				if (k != 3 && k != 4 && k != 5 && l2[k + 3] == 2 && l2[k + 4] == 2 && l2[k + 5] == 2 && l2[k + 2] != 2 && l2[k + 6] != 2 && (l2[k + 1] != 2 || (l2[k + 2] != 0 && l2[k + 2] != 2)) && (l2[k + 7] != 2 || (l2[k + 6] != 0 && l2[k + 6] != 2))) {
					t = 0; u = 0;
					if (l2[k + 2] != 0) { t += 1; }
					else if (l2[k + 1] != 0 && l2[k + 1] != 2) { u += 1; }
					if (l2[k + 6] != 0) { t += 1; }
					else if (l2[k + 7] != 0 && l2[k + 7] != 2) { u += 1; }
					if (t == 0 && u <= 1) { cl32 += 1; }
					if ((t == 0 && u == 2) || (t == 1 && u == 0)) { cs32 += 1; }
				}
				if (k != 3 && k != 4 && k != 5 && l3[k + 3] == 2 && l3[k + 4] == 2 && l3[k + 5] == 2 && l3[k + 2] != 2 && l3[k + 6] != 2 && (l3[k + 1] != 2 || (l3[k + 2] != 0 && l3[k + 2] != 2)) && (l3[k + 7] != 2 || (l3[k + 6] != 0 && l3[k + 6] != 2))) {
					t = 0; u = 0;
					if (l3[k + 2] != 0) { t += 1; }
					else if (l3[k + 1] != 0 && l3[k + 1] != 2) { u += 1; }
					if (l3[k + 6] != 0) { t += 1; }
					else if (l3[k + 7] != 0 && l3[k + 7] != 2) { u += 1; }
					if (t == 0 && u <= 1) { cl32 += 1; }
					if ((t == 0 && u == 2) || (t == 1 && u == 0)) { cs32 += 1; }
				}
				if (k != 1 && k != 4 && k != 5 && l0[k + 2] == 1 && l0[k + 3] == 1 && l0[k + 5] == 1 && l0[k + 4] == 0 && l0[k + 1] != 1 && l0[k + 6] != 1) {
					t = 0;
					if (l0[k + 1] != 0 || l0[k] == 1) { t += 1; }
					if (l0[k + 6] != 0 || l0[k + 7] == 1) { t += 1; }
					if (t == 0) { jl31 += 1; }
					if (t == 1) { js31 += 1; }
				}
				if (k != 2 && k != 4 && k != 5 && l0[k + 2] == 1 && l0[k + 4] == 1 && l0[k + 5] == 1 && l0[k + 3] == 0 && l0[k + 1] != 1 && l0[k + 6] != 1) {
					t = 0;
					if (l0[k + 1] != 0 || l0[k] == 1) { t += 1; }
					if (l0[k + 6] != 0 || l0[k + 7] == 1) { t += 1; }
					if (t == 0) { jl31 += 1; }
					if (t == 1) { js31 += 1; }
				}
				if (k != 1 && k != 4 && k != 5 && l1[k + 2] == 1 && l1[k + 3] == 1 && l1[k + 5] == 1 && l1[k + 4] == 0 && l1[k + 1] != 1 && l1[k + 6] != 1) {
					t = 0;
					if (l1[k + 1] != 0 || l1[k] == 1) { t += 1; }
					if (l1[k + 6] != 0 || l1[k + 7] == 1) { t += 1; }
					if (t == 0) { jl31 += 1; }
					if (t == 1) { js31 += 1; }
				}
				if (k != 2 && k != 4 && k != 5 && l1[k + 2] == 1 && l1[k + 4] == 1 && l1[k + 5] == 1 && l1[k + 3] == 0 && l1[k + 1] != 1 && l1[k + 6] != 1) {
					t = 0;
					if (l1[k + 1] != 0 || l1[k] == 1) { t += 1; }
					if (l1[k + 6] != 0 || l1[k + 7] == 1) { t += 1; }
					if (t == 0) { jl31 += 1; }
					if (t == 1) { js31 += 1; }
				}
				if (k != 1 && k != 4 && k != 5 && l2[k + 2] == 1 && l2[k + 3] == 1 && l2[k + 5] == 1 && l2[k + 4] == 0 && l2[k + 1] != 1 && l2[k + 6] != 1) {
					t = 0;
					if (l2[k + 1] != 0 || l2[k] == 1) { t += 1; }
					if (l2[k + 6] != 0 || l2[k + 7] == 1) { t += 1; }
					if (t == 0) { jl31 += 1; }
					if (t == 1) { js31 += 1; }
				}
				if (k != 2 && k != 4 && k != 5 && l2[k + 2] == 1 && l2[k + 4] == 1 && l2[k + 5] == 1 && l2[k + 3] == 0 && l2[k + 1] != 1 && l2[k + 6] != 1) {
					t = 0;
					if (l2[k + 1] != 0 || l2[k] == 1) { t += 1; }
					if (l2[k + 6] != 0 || l2[k + 7] == 1) { t += 1; }
					if (t == 0) { jl31 += 1; }
					if (t == 1) { js31 += 1; }
				}
				if (k != 1 && k != 4 && k != 5 && l3[k + 2] == 1 && l3[k + 3] == 1 && l3[k + 5] == 1 && l3[k + 4] == 0 && l3[k + 1] != 1 && l3[k + 6] != 1) {
					t = 0;
					if (l3[k + 1] != 0 || l3[k] == 1) { t += 1; }
					if (l3[k + 6] != 0 || l3[k + 7] == 1) { t += 1; }
					if (t == 0) { jl31 += 1; }
					if (t == 1) { js31 += 1; }
				}
				if (k != 2 && k != 4 && k != 5 && l3[k + 2] == 1 && l3[k + 4] == 1 && l3[k + 5] == 1 && l3[k + 3] == 0 && l3[k + 1] != 1 && l3[k + 6] != 1) {
					t = 0;
					if (l3[k + 1] != 0 || l3[k] == 1) { t += 1; }
					if (l3[k + 6] != 0 || l3[k + 7] == 1) { t += 1; }
					if (t == 0) { jl31 += 1; }
					if (t == 1) { js31 += 1; }
				}
				if (k != 1 && k != 4 && k != 5 && l0[k + 2] == 2 && l0[k + 3] == 2 && l0[k + 5] == 2 && l0[k + 4] == 0 && l0[k + 1] != 2 && l0[k + 6] != 2) {
					t = 0;
					if (l0[k + 1] != 0) { t += 1; }
					if (l0[k + 6] != 0) { t += 1; }
					if (t == 0) { jl32 += 1; }
					if (t == 1) { js32 += 1; }
				}
				if (k != 2 && k != 4 && k != 5 && l0[k + 2] == 2 && l0[k + 4] == 2 && l0[k + 5] == 2 && l0[k + 3] == 0 && l0[k + 1] != 2 && l0[k + 6] != 2) {
					t = 0;
					if (l0[k + 1] != 0) { t += 1; }
					if (l0[k + 6] != 0) { t += 1; }
					if (t == 0) { jl32 += 1; }
					if (t == 1) { js32 += 1; }
				}
				if (k != 1 && k != 4 && k != 5 && l1[k + 2] == 2 && l1[k + 3] == 2 && l1[k + 5] == 2 && l1[k + 4] == 0 && l1[k + 1] != 2 && l1[k + 6] != 2) {
					t = 0;
					if (l1[k + 1] != 0) { t += 1; }
					if (l1[k + 6] != 0) { t += 1; }
					if (t == 0) { jl32 += 1; }
					if (t == 1) { js32 += 1; }
				}
				if (k != 2 && k != 4 && k != 5 && l1[k + 2] == 2 && l1[k + 4] == 2 && l1[k + 5] == 2 && l1[k + 3] == 0 && l1[k + 1] != 2 && l1[k + 6] != 2) {
					t = 0;
					if (l1[k + 1] != 0) { t += 1; }
					if (l1[k + 6] != 0) { t += 1; }
					if (t == 0) { jl32 += 1; }
					if (t == 1) { js32 += 1; }
				}
				if (k != 1 && k != 4 && k != 5 && l2[k + 2] == 2 && l2[k + 3] == 2 && l2[k + 5] == 2 && l2[k + 4] == 0 && l2[k + 1] != 2 && l2[k + 6] != 2) {
					t = 0;
					if (l2[k + 1] != 0) { t += 1; }
					if (l2[k + 6] != 0) { t += 1; }
					if (t == 0) { jl32 += 1; }
					if (t == 1) { js32 += 1; }
				}
				if (k != 2 && k != 4 && k != 5 && l2[k + 2] == 2 && l2[k + 4] == 2 && l2[k + 5] == 2 && l2[k + 3] == 0 && l2[k + 1] != 2 && l2[k + 6] != 2) {
					t = 0;
					if (l2[k + 1] != 0) { t += 1; }
					if (l2[k + 6] != 0) { t += 1; }
					if (t == 0) { jl32 += 1; }
					if (t == 1) { js32 += 1; }
				}
				if (k != 1 && k != 4 && k != 5 && l3[k + 2] == 2 && l3[k + 3] == 2 && l3[k + 5] == 2 && l3[k + 4] == 0 && l3[k + 1] != 2 && l3[k + 6] != 2) {
					t = 0;
					if (l3[k + 1] != 0) { t += 1; }
					if (l3[k + 6] != 0) { t += 1; }
					if (t == 0) { jl32 += 1; }
					if (t == 1) { js32 += 1; }
				}
				if (k != 2 && k != 4 && k != 5 && l3[k + 2] == 2 && l3[k + 4] == 2 && l3[k + 5] == 2 && l3[k + 3] == 0 && l3[k + 1] != 2 && l3[k + 6] != 2) {
					t = 0;
					if (l3[k + 1] != 0) { t += 1; }
					if (l3[k + 6] != 0) { t += 1; }
					if (t == 0) { jl32 += 1; }
					if (t == 1) { js32 += 1; }
				}
				if (k != 1 && k != 2 && k != 5 && l0[k + 1] == 2 && l0[k + 2] == 2 && l0[k + 5] == 2 && l0[k + 3] == 0 && l0[k + 4] == 0) { bjs32 += 1; }
				if (k != 2 && k != 3 && k != 5 && l0[k + 1] == 2 && l0[k + 4] == 2 && l0[k + 5] == 2 && l0[k + 2] == 0 && l0[k + 3] == 0) { bjs32 += 1; }
				if (k != 1 && k != 3 && k != 5 && l0[k + 1] == 2 && l0[k + 3] == 2 && l0[k + 5] == 2 && l0[k + 2] == 0 && l0[k + 4] == 0) { jjs32 += 1; }
				if (k != 1 && k != 2 && k != 5 && l1[k + 1] == 2 && l1[k + 2] == 2 && l1[k + 5] == 2 && l1[k + 3] == 0 && l1[k + 4] == 0) { bjs32 += 1; }
				if (k != 2 && k != 3 && k != 5 && l1[k + 1] == 2 && l1[k + 4] == 2 && l1[k + 5] == 2 && l1[k + 2] == 0 && l1[k + 3] == 0) { bjs32 += 1; }
				if (k != 1 && k != 3 && k != 5 && l1[k + 1] == 2 && l1[k + 3] == 2 && l1[k + 5] == 2 && l1[k + 2] == 0 && l1[k + 4] == 0) { jjs32 += 1; }
				if (k != 1 && k != 2 && k != 5 && l2[k + 1] == 2 && l2[k + 2] == 2 && l2[k + 5] == 2 && l2[k + 3] == 0 && l2[k + 4] == 0) { bjs32 += 1; }
				if (k != 2 && k != 3 && k != 5 && l2[k + 1] == 2 && l2[k + 4] == 2 && l2[k + 5] == 2 && l2[k + 2] == 0 && l2[k + 3] == 0) { bjs32 += 1; }
				if (k != 1 && k != 3 && k != 5 && l2[k + 1] == 2 && l2[k + 3] == 2 && l2[k + 5] == 2 && l2[k + 2] == 0 && l2[k + 4] == 0) { jjs32 += 1; }
				if (k != 1 && k != 2 && k != 5 && l3[k + 1] == 2 && l3[k + 2] == 2 && l3[k + 5] == 2 && l3[k + 3] == 0 && l3[k + 4] == 0) { bjs32 += 1; }
				if (k != 2 && k != 3 && k != 5 && l3[k + 1] == 2 && l3[k + 4] == 2 && l3[k + 5] == 2 && l3[k + 2] == 0 && l3[k + 3] == 0) { bjs32 += 1; }
				if (k != 1 && k != 3 && k != 5 && l3[k + 1] == 2 && l3[k + 3] == 2 && l3[k + 5] == 2 && l3[k + 2] == 0 && l3[k + 4] == 0) { jjs32 += 1; }
				if (k != 1 && k != 2 && k != 5 && l0[k + 1] == 1 && l0[k + 2] == 1 && l0[k + 5] == 1 && l0[k + 3] == 0 && l0[k + 4] == 0) { bjs31 += 1; }
				if (k != 2 && k != 3 && k != 5 && l0[k + 1] == 1 && l0[k + 4] == 1 && l0[k + 5] == 1 && l0[k + 2] == 0 && l0[k + 3] == 0) { bjs31 += 1; }
				if (k != 1 && k != 3 && k != 5 && l0[k + 1] == 1 && l0[k + 3] == 1 && l0[k + 5] == 1 && l0[k + 2] == 0 && l0[k + 4] == 0) { jjs31 += 1; }
				if (k != 1 && k != 2 && k != 5 && l1[k + 1] == 1 && l1[k + 2] == 1 && l1[k + 5] == 1 && l1[k + 3] == 0 && l1[k + 4] == 0) { bjs31 += 1; }
				if (k != 2 && k != 3 && k != 5 && l1[k + 1] == 1 && l1[k + 4] == 1 && l1[k + 5] == 1 && l1[k + 2] == 0 && l1[k + 3] == 0) { bjs31 += 1; }
				if (k != 1 && k != 3 && k != 5 && l1[k + 1] == 1 && l1[k + 3] == 1 && l1[k + 5] == 1 && l1[k + 2] == 0 && l1[k + 4] == 0) { jjs31 += 1; }
				if (k != 1 && k != 2 && k != 5 && l2[k + 1] == 1 && l2[k + 2] == 1 && l2[k + 5] == 1 && l2[k + 3] == 0 && l2[k + 4] == 0) { bjs31 += 1; }
				if (k != 2 && k != 3 && k != 5 && l2[k + 1] == 1 && l2[k + 4] == 1 && l2[k + 5] == 1 && l2[k + 2] == 0 && l2[k + 3] == 0) { bjs31 += 1; }
				if (k != 1 && k != 3 && k != 5 && l2[k + 1] == 1 && l2[k + 3] == 1 && l2[k + 5] == 1 && l2[k + 2] == 0 && l2[k + 4] == 0) { jjs31 += 1; }
				if (k != 1 && k != 2 && k != 5 && l3[k + 1] == 1 && l3[k + 2] == 1 && l3[k + 5] == 1 && l3[k + 3] == 0 && l3[k + 4] == 0) { bjs31 += 1; }
				if (k != 2 && k != 3 && k != 5 && l3[k + 1] == 1 && l3[k + 4] == 1 && l3[k + 5] == 1 && l3[k + 2] == 0 && l3[k + 3] == 0) { bjs31 += 1; }
				if (k != 1 && k != 3 && k != 5 && l3[k + 1] == 1 && l3[k + 3] == 1 && l3[k + 5] == 1 && l3[k + 2] == 0 && l3[k + 4] == 0) { jjs31 += 1; }
				if ((k == 0 || k == 1) && l0[k + 4] == 1 && l0[k + 5] == 1 && l0[k + 3] == 0 && l0[k + 6] == 0 && l0[k + 2] != 1 && l0[k + 7] != 1 && (l0[k + 1] != 1 || (l0[k + 2] == 2 && l0[k + 1] == 1)) && (l0[k + 8] != 1 || (l0[k + 7] == 2 && l0[k + 8] == 1))) { cl21 += 1; }
				if ((k == 0 || k == 2) && l0[k + 3] == 1 && l0[k + 5] == 1 && l0[k + 4] == 0 && l0[k + 2] == 0 && l0[k + 6] == 0 && l0[k + 1] != 1 && l0[k + 7] != 1) { jl21 += 1; }
				if ((k == 0 || k == 3) && l0[k + 2] == 1 && l0[k + 5] == 1 && l0[k + 3] == 0 && l0[k + 4] == 0 && l0[k + 1] == 0 && l0[k + 6] == 0) { bjl21 += 1; }
				if ((k == 0 || k == 1) && l1[k + 4] == 1 && l1[k + 5] == 1 && l1[k + 3] == 0 && l1[k + 6] == 0 && l1[k + 2] != 1 && l1[k + 7] != 1 && (l1[k + 1] != 1 || (l1[k + 2] == 2 && l1[k + 1] == 1)) && (l1[k + 8] != 1 || (l1[k + 7] == 2 && l1[k + 8] == 1))) { cl21 += 1; }
				if ((k == 0 || k == 2) && l1[k + 3] == 1 && l1[k + 5] == 1 && l1[k + 4] == 0 && l1[k + 2] == 0 && l1[k + 6] == 0 && l1[k + 1] != 1 && l1[k + 7] != 1) { jl21 += 1; }
				if ((k == 0 || k == 3) && l1[k + 2] == 1 && l1[k + 5] == 1 && l1[k + 3] == 0 && l1[k + 4] == 0 && l1[k + 1] == 0 && l1[k + 6] == 0) { bjl21 += 1; }
				if ((k == 0 || k == 1) && l2[k + 4] == 1 && l2[k + 5] == 1 && l2[k + 3] == 0 && l2[k + 6] == 0 && l2[k + 2] != 1 && l2[k + 7] != 1 && (l2[k + 1] != 1 || (l2[k + 2] == 2 && l2[k + 1] == 1)) && (l2[k + 8] != 1 || (l2[k + 7] == 2 && l2[k + 8] == 1))) { cl21 += 1; }
				if ((k == 0 || k == 2) && l2[k + 3] == 1 && l2[k + 5] == 1 && l2[k + 4] == 0 && l2[k + 2] == 0 && l2[k + 6] == 0 && l2[k + 1] != 1 && l2[k + 7] != 1) { jl21 += 1; }
				if ((k == 0 || k == 3) && l2[k + 2] == 1 && l2[k + 5] == 1 && l2[k + 3] == 0 && l2[k + 4] == 0 && l2[k + 1] == 0 && l2[k + 6] == 0) { bjl21 += 1; }
				if ((k == 0 || k == 1) && l3[k + 4] == 1 && l3[k + 5] == 1 && l3[k + 3] == 0 && l3[k + 6] == 0 && l3[k + 2] != 1 && l3[k + 7] != 1 && (l3[k + 1] != 1 || (l3[k + 2] == 2 && l3[k + 1] == 1)) && (l3[k + 8] != 1 || (l3[k + 7] == 2 && l3[k + 8] == 1))) { cl21 += 1; }
				if ((k == 0 || k == 2) && l3[k + 3] == 1 && l3[k + 5] == 1 && l3[k + 4] == 0 && l3[k + 2] == 0 && l3[k + 6] == 0 && l3[k + 1] != 1 && l3[k + 7] != 1) { jl21 += 1; }
				if ((k == 0 || k == 3) && l3[k + 2] == 1 && l3[k + 5] == 1 && l3[k + 3] == 0 && l3[k + 4] == 0 && l3[k + 1] == 0 && l3[k + 6] == 0) { bjl21 += 1; }
				if ((k == 0 || k == 1) && l0[k + 4] == 2 && l0[k + 5] == 2 && l0[k + 3] == 0 && l0[k + 6] == 0 && l0[k + 2] != 2 && l0[k + 7] != 2 && (l0[k + 1] != 2 || (l0[k + 2] == 1 && l0[k + 1] == 2)) && (l0[k + 8] != 2 || (l0[k + 7] == 1 && l0[k + 8] == 2))) { cl22 += 1; }
				if ((k == 0 || k == 2) && l0[k + 3] == 2 && l0[k + 5] == 2 && l0[k + 4] == 0 && l0[k + 2] == 0 && l0[k + 6] == 0 && l0[k + 1] != 2 && l0[k + 7] != 2) { jl22 += 1; }
				if ((k == 0 || k == 3) && l0[k + 2] == 2 && l0[k + 5] == 2 && l0[k + 3] == 0 && l0[k + 4] == 0 && l0[k + 1] == 0 && l0[k + 6] == 0) { bjl22 += 1; }
				if ((k == 0 || k == 1) && l1[k + 4] == 2 && l1[k + 5] == 2 && l1[k + 3] == 0 && l1[k + 6] == 0 && l1[k + 2] != 2 && l1[k + 7] != 2 && (l1[k + 1] != 2 || (l1[k + 2] == 1 && l1[k + 1] == 2)) && (l1[k + 8] != 2 || (l1[k + 7] == 1 && l1[k + 8] == 2))) { cl22 += 1; }
				if ((k == 0 || k == 2) && l1[k + 3] == 2 && l1[k + 5] == 2 && l1[k + 4] == 0 && l1[k + 2] == 0 && l1[k + 6] == 0 && l1[k + 1] != 2 && l1[k + 7] != 2) { jl22 += 1; }
				if ((k == 0 || k == 3) && l1[k + 2] == 2 && l1[k + 5] == 2 && l1[k + 3] == 0 && l1[k + 4] == 0 && l1[k + 1] == 0 && l1[k + 6] == 0) { bjl22 += 1; }
				if ((k == 0 || k == 1) && l2[k + 4] == 2 && l2[k + 5] == 2 && l2[k + 3] == 0 && l2[k + 6] == 0 && l2[k + 2] != 2 && l2[k + 7] != 2 && (l2[k + 1] != 2 || (l2[k + 2] == 1 && l2[k + 1] == 2)) && (l2[k + 8] != 2 || (l2[k + 7] == 1 && l2[k + 8] == 2))) { cl22 += 1; }
				if ((k == 0 || k == 2) && l2[k + 3] == 2 && l2[k + 5] == 2 && l2[k + 4] == 0 && l2[k + 2] == 0 && l2[k + 6] == 0 && l2[k + 1] != 2 && l2[k + 7] != 2) { jl22 += 1; }
				if ((k == 0 || k == 3) && l2[k + 2] == 2 && l2[k + 5] == 2 && l2[k + 3] == 0 && l2[k + 4] == 0 && l2[k + 1] == 0 && l2[k + 6] == 0) { bjl22 += 1; }
				if ((k == 0 || k == 1) && l3[k + 4] == 2 && l3[k + 5] == 2 && l3[k + 3] == 0 && l3[k + 6] == 0 && l3[k + 2] != 2 && l3[k + 7] != 2 && (l3[k + 1] != 2 || (l3[k + 2] == 1 && l3[k + 1] == 2)) && (l3[k + 8] != 2 || (l3[k + 7] == 1 && l3[k + 8] == 2))) { cl22 += 1; }
				if ((k == 0 || k == 2) && l3[k + 3] == 2 && l3[k + 5] == 2 && l3[k + 4] == 0 && l3[k + 2] == 0 && l3[k + 6] == 0 && l3[k + 1] != 2 && l3[k + 7] != 2) { jl22 += 1; }
				if ((k == 0 || k == 3) && l3[k + 2] == 2 && l3[k + 5] == 2 && l3[k + 3] == 0 && l3[k + 4] == 0 && l3[k + 1] == 0 && l3[k + 6] == 0) { bjl22 += 1; }
				if (k == 0 && l0[k + 5] == 1 && l0[k + 4] == 0 && l0[k + 6] == 0 && l0[k + 3] != 1 && l0[k + 7] != 1 && (l0[k + 3] == 0 || l0[k + 2] != 1) && (l0[k + 7] == 0 || l0[k + 8] != 1) && (l0[k + 3] == 0 || l0[k + 2] == 0 || l0[k + 1] != 1) && (l0[k + 7] == 0 || l0[k + 8] == 0 || l0[k + 9] != 1)) { l11 += 1; }
				if (k == 0 && l0[k + 5] == 1 && l0[k + 4] != 0 && l0[k + 4] != 1 && l0[k + 6] == 0 && l0[k + 7] == 0 && l0[k + 8] == 0 && l0[k + 9] == 0 && l0[k + 10] != 1) { s11 += 1; }
				if (k == 0 && l0[k + 5] == 1 && l0[k + 6] != 0 && l0[k + 6] != 1 && l0[k + 4] == 0 && l0[k + 3] == 0 && l0[k + 2] == 0 && l0[k + 1] == 0 && l0[k] != 1) { s11 += 1; }
				if (k == 0 && l1[k + 5] == 1 && l1[k + 4] == 0 && l1[k + 6] == 0 && l1[k + 3] != 1 && l1[k + 7] != 1 && (l1[k + 3] == 0 || l1[k + 2] != 1) && (l1[k + 7] == 0 || l1[k + 8] != 1) && (l1[k + 3] == 0 || l1[k + 2] == 0 || l1[k + 1] != 1) && (l1[k + 7] == 0 || l1[k + 8] == 0 || l1[k + 9] != 1)) { l11 += 1; }
				if (k == 0 && l1[k + 5] == 1 && l1[k + 4] != 0 && l1[k + 4] != 1 && l1[k + 6] == 0 && l1[k + 7] == 0 && l1[k + 8] == 0 && l1[k + 9] == 0 && l1[k + 10] != 1) { s11 += 1; }
				if (k == 0 && l1[k + 5] == 1 && l1[k + 6] != 0 && l1[k + 6] != 1 && l1[k + 4] == 0 && l1[k + 3] == 0 && l1[k + 2] == 0 && l1[k + 1] == 0 && l1[k] != 1) { s11 += 1; }
				if (k == 0 && l2[k + 5] == 1 && l2[k + 4] == 0 && l2[k + 6] == 0 && l2[k + 3] != 1 && l2[k + 7] != 1 && (l2[k + 3] == 0 || l2[k + 2] != 1) && (l2[k + 7] == 0 || l2[k + 8] != 1) && (l2[k + 3] == 0 || l2[k + 2] == 0 || l2[k + 1] != 1) && (l2[k + 7] == 0 || l2[k + 8] == 0 || l2[k + 9] != 1)) { l11 += 1; }
				if (k == 0 && l2[k + 5] == 1 && l2[k + 4] != 0 && l2[k + 4] != 1 && l2[k + 6] == 0 && l2[k + 7] == 0 && l2[k + 8] == 0 && l2[k + 9] == 0 && l2[k + 10] != 1) { s11 += 1; }
				if (k == 0 && l2[k + 5] == 1 && l2[k + 6] != 0 && l2[k + 6] != 1 && l2[k + 4] == 0 && l2[k + 3] == 0 && l2[k + 2] == 0 && l2[k + 1] == 0 && l2[k] != 1) { s11 += 1; }
				if (k == 0 && l2[k + 5] == 1 && l2[k + 4] == 0 && l2[k + 6] == 0 && l2[k + 3] != 1 && l2[k + 7] != 1 && (l2[k + 3] == 0 || l2[k + 2] != 1) && (l2[k + 7] == 0 || l2[k + 8] != 1) && (l2[k + 3] == 0 || l2[k + 2] == 0 || l2[k + 1] != 1) && (l2[k + 7] == 0 || l2[k + 8] == 0 || l2[k + 9] != 1)) { l11 += 1; }
				if (k == 0 && l2[k + 5] == 1 && l2[k + 4] != 0 && l2[k + 4] != 1 && l2[k + 6] == 0 && l2[k + 7] == 0 && l2[k + 8] == 0 && l2[k + 9] == 0 && l2[k + 10] != 1) { s11 += 1; }
				if (k == 0 && l2[k + 5] == 1 && l2[k + 6] != 0 && l2[k + 6] != 1 && l2[k + 4] == 0 && l2[k + 3] == 0 && l2[k + 2] == 0 && l2[k + 1] == 0 && l2[k] != 1) { s11 += 1; }
				if (k == 0 && l0[k + 5] == 2 && l0[k + 4] == 0 && l0[k + 6] == 0 && l0[k + 3] != 2 && l0[k + 7] != 2 && (l0[k + 3] == 0 || l0[k + 2] != 2) && (l0[k + 7] == 0 || l0[k + 8] != 2) && (l0[k + 3] == 0 || l0[k + 2] == 0 || l0[k + 1] != 2) && (l0[k + 7] == 0 || l0[k + 8] == 0 || l0[k + 9] != 2)) { l12 += 1; }
				if (k == 0 && l0[k + 5] == 2 && l0[k + 4] != 0 && l0[k + 4] != 2 && l0[k + 6] == 0 && l0[k + 7] == 0 && l0[k + 8] == 0 && l0[k + 9] == 0) { s12 += 1; }
				if (k == 0 && l0[k + 5] == 2 && l0[k + 6] != 0 && l0[k + 6] != 2 && l0[k + 4] == 0 && l0[k + 3] == 0 && l0[k + 2] == 0 && l0[k + 1] == 0) { s12 += 1; }
				if (k == 0 && l1[k + 5] == 2 && l1[k + 4] == 0 && l1[k + 6] == 0 && l1[k + 3] != 2 && l1[k + 7] != 2 && (l1[k + 3] == 0 || l1[k + 2] != 2) && (l1[k + 7] == 0 || l1[k + 8] != 2) && (l1[k + 3] == 0 || l1[k + 2] == 0 || l1[k + 1] != 2) && (l1[k + 7] == 0 || l1[k + 8] == 0 || l1[k + 9] != 2)) { l12 += 1; }
				if (k == 0 && l1[k + 5] == 2 && l1[k + 4] != 0 && l1[k + 4] != 2 && l1[k + 6] == 0 && l1[k + 7] == 0 && l1[k + 8] == 0 && l1[k + 9] == 0) { s12 += 1; }
				if (k == 0 && l1[k + 5] == 2 && l1[k + 6] != 0 && l1[k + 6] != 2 && l1[k + 4] == 0 && l1[k + 3] == 0 && l1[k + 2] == 0 && l1[k + 1] == 0) { s12 += 1; }
				if (k == 0 && l2[k + 5] == 2 && l2[k + 4] == 0 && l2[k + 6] == 0 && l2[k + 3] != 2 && l2[k + 7] != 2 && (l2[k + 3] == 0 || l2[k + 2] != 2) && (l2[k + 7] == 0 || l2[k + 8] != 2) && (l2[k + 3] == 0 || l2[k + 2] == 0 || l2[k + 1] != 2) && (l2[k + 7] == 0 || l2[k + 8] == 0 || l2[k + 9] != 2)) { l12 += 1; }
				if (k == 0 && l2[k + 5] == 2 && l2[k + 4] != 0 && l2[k + 4] != 2 && l2[k + 6] == 0 && l2[k + 7] == 0 && l2[k + 8] == 0 && l2[k + 9] == 0) { s12 += 1; }
				if (k == 0 && l2[k + 5] == 2 && l2[k + 6] != 0 && l2[k + 6] != 2 && l2[k + 4] == 0 && l2[k + 3] == 0 && l2[k + 2] == 0 && l2[k + 1] == 0) { s12 += 1; }
				if (k == 0 && l3[k + 5] == 2 && l3[k + 4] == 0 && l3[k + 6] == 0 && l3[k + 3] != 2 && l3[k + 7] != 2 && (l3[k + 3] == 0 || l3[k + 2] != 2) && (l3[k + 7] == 0 || l3[k + 8] != 2) && (l3[k + 3] == 0 || l3[k + 2] == 0 || l3[k + 1] != 2) && (l3[k + 7] == 0 || l3[k + 8] == 0 || l3[k + 9] != 2)) { l12 += 1; }
				if (k == 0 && l3[k + 5] == 2 && l3[k + 4] != 0 && l3[k + 4] != 2 && l3[k + 6] == 0 && l3[k + 7] == 0 && l3[k + 8] == 0 && l3[k + 9] == 0) { s12 += 1; }
				if (k == 0 && l3[k + 5] == 2 && l3[k + 6] != 0 && l3[k + 6] != 2 && l3[k + 4] == 0 && l3[k + 3] == 0 && l3[k + 2] == 0 && l3[k + 1] == 0) { s12 += 1; }
				if ((k == 0 || k == 1) && l0[k + 4] == 1 && l0[k + 5] == 1 && l0[k + 3] != 0 && l0[k + 3] != 1 && l0[k + 6] == 0 && l0[k + 7] == 0 && l0[k + 8] == 0) { cs21 += 1; }
				if ((k == 0 || k == 1) && l0[k + 4] == 1 && l0[k + 5] == 1 && l0[k + 6] != 0 && l0[k + 6] != 1 && l0[k + 3] == 0 && l0[k + 2] == 0 && l0[k + 1] == 0) { cs21 += 1; }
				if ((k == 0 || k == 1) && l1[k + 4] == 1 && l1[k + 5] == 1 && l1[k + 3] != 0 && l1[k + 3] != 1 && l1[k + 6] == 0 && l1[k + 7] == 0 && l1[k + 8] == 0) { cs21 += 1; }
				if ((k == 0 || k == 1) && l1[k + 4] == 1 && l1[k + 5] == 1 && l1[k + 6] != 0 && l1[k + 6] != 1 && l1[k + 3] == 0 && l1[k + 2] == 0 && l1[k + 1] == 0) { cs21 += 1; }
				if ((k == 0 || k == 1) && l2[k + 4] == 1 && l2[k + 5] == 1 && l2[k + 3] != 0 && l2[k + 3] != 1 && l2[k + 6] == 0 && l2[k + 7] == 0 && l2[k + 8] == 0) { cs21 += 1; }
				if ((k == 0 || k == 1) && l2[k + 4] == 1 && l2[k + 5] == 1 && l2[k + 6] != 0 && l2[k + 6] != 1 && l2[k + 3] == 0 && l2[k + 2] == 0 && l2[k + 1] == 0) { cs21 += 1; }
				if ((k == 0 || k == 1) && l3[k + 4] == 1 && l3[k + 5] == 1 && l3[k + 3] != 0 && l3[k + 3] != 1 && l3[k + 6] == 0 && l3[k + 7] == 0 && l3[k + 8] == 0) { cs21 += 1; }
				if ((k == 0 || k == 1) && l3[k + 4] == 1 && l3[k + 5] == 1 && l3[k + 6] != 0 && l3[k + 6] != 1 && l3[k + 3] == 0 && l3[k + 2] == 0 && l3[k + 1] == 0) { cs21 += 1; }
				if ((k == 0 || k == 1) && l0[k + 4] == 2 && l0[k + 5] == 2 && l0[k + 3] != 0 && l0[k + 3] != 2 && l0[k + 6] == 0 && l0[k + 7] == 0 && l0[k + 8] == 0) { cs22 += 1; }
				if ((k == 0 || k == 1) && l0[k + 4] == 2 && l0[k + 5] == 2 && l0[k + 6] != 0 && l0[k + 6] != 2 && l0[k + 3] == 0 && l0[k + 2] == 0 && l0[k + 1] == 0) { cs22 += 1; }
				if ((k == 0 || k == 1) && l1[k + 4] == 2 && l1[k + 5] == 2 && l1[k + 3] != 0 && l1[k + 3] != 2 && l1[k + 6] == 0 && l1[k + 7] == 0 && l1[k + 8] == 0) { cs22 += 1; }
				if ((k == 0 || k == 1) && l1[k + 4] == 2 && l1[k + 5] == 2 && l1[k + 6] != 0 && l1[k + 6] != 2 && l1[k + 3] == 0 && l1[k + 2] == 0 && l1[k + 1] == 0) { cs22 += 1; }
				if ((k == 0 || k == 1) && l2[k + 4] == 2 && l2[k + 5] == 2 && l2[k + 3] != 0 && l2[k + 3] != 2 && l2[k + 6] == 0 && l2[k + 7] == 0 && l2[k + 8] == 0) { cs22 += 1; }
				if ((k == 0 || k == 1) && l2[k + 4] == 2 && l2[k + 5] == 2 && l2[k + 6] != 0 && l2[k + 6] != 2 && l2[k + 3] == 0 && l2[k + 2] == 0 && l2[k + 1] == 0) { cs22 += 1; }
				if ((k == 0 || k == 1) && l3[k + 4] == 2 && l3[k + 5] == 2 && l3[k + 3] != 0 && l3[k + 3] != 2 && l3[k + 6] == 0 && l3[k + 7] == 0 && l3[k + 8] == 0) { cs22 += 1; }
				if ((k == 0 || k == 1) && l3[k + 4] == 2 && l3[k + 5] == 2 && l3[k + 6] != 0 && l3[k + 6] != 2 && l3[k + 3] == 0 && l3[k + 2] == 0 && l3[k + 1] == 0) { cs22 += 1; }
				if ((k == 0 || k == 2) && l0[k + 3] == 1 && l0[k + 5] == 1 && l0[k + 2] != 0 && l0[k + 2] != 1 && l0[k + 6] == 0 && l0[k + 7] == 0 && l0[k + 8] != 1 && l0[k + 4] == 0) { js21 += 1; }
				if ((k == 0 || k == 2) && l1[k + 3] == 1 && l1[k + 5] == 1 && l1[k + 2] != 0 && l1[k + 2] != 1 && l1[k + 6] == 0 && l1[k + 7] == 0 && l1[k + 8] != 1 && l1[k + 4] == 0) { js21 += 1; }
				if ((k == 0 || k == 2) && l2[k + 3] == 1 && l2[k + 5] == 1 && l2[k + 2] != 0 && l2[k + 2] != 1 && l2[k + 6] == 0 && l2[k + 7] == 0 && l2[k + 8] != 1 && l2[k + 4] == 0) { js21 += 1; }
				if ((k == 0 || k == 2) && l3[k + 3] == 1 && l3[k + 5] == 1 && l3[k + 2] != 0 && l3[k + 2] != 1 && l3[k + 6] == 0 && l3[k + 7] == 0 && l3[k + 8] != 1 && l3[k + 4] == 0) { js21 += 1; }
				if ((k == 0 || k == 2) && l0[k + 3] == 2 && l0[k + 5] == 2 && l0[k + 2] != 0 && l0[k + 2] != 2 && l0[k + 6] == 0 && l0[k + 7] == 0 && l0[k + 4] == 0) { js22 += 1; }
				if ((k == 0 || k == 2) && l1[k + 3] == 2 && l1[k + 5] == 2 && l1[k + 2] != 0 && l1[k + 2] != 2 && l1[k + 6] == 0 && l1[k + 7] == 0 && l1[k + 4] == 0) { js22 += 1; }
				if ((k == 0 || k == 2) && l2[k + 3] == 2 && l2[k + 5] == 2 && l2[k + 2] != 0 && l2[k + 2] != 2 && l2[k + 6] == 0 && l2[k + 7] == 0 && l2[k + 4] == 0) { js22 += 1; }
				if ((k == 0 || k == 2) && l3[k + 3] == 2 && l3[k + 5] == 2 && l3[k + 2] != 0 && l3[k + 2] != 2 && l3[k + 6] == 0 && l3[k + 7] == 0 && l3[k + 4] == 0) { js22 += 1; }
				if ((k == 0 || k == 2) && l0[k + 3] == 1 && l0[k + 5] == 1 && l0[k + 6] != 0 && l0[k + 6] != 1 && l0[k + 2] == 0 && l0[k + 1] == 0 && l0[k] != 1 && l0[k + 4] == 0) { js21 += 1; }
				if ((k == 0 || k == 2) && l1[k + 3] == 1 && l1[k + 5] == 1 && l1[k + 6] != 0 && l1[k + 6] != 1 && l1[k + 2] == 0 && l1[k + 1] == 0 && l1[k] != 1 && l1[k + 4] == 0) { js21 += 1; }
				if ((k == 0 || k == 2) && l2[k + 3] == 1 && l2[k + 5] == 1 && l2[k + 6] != 0 && l2[k + 6] != 1 && l2[k + 2] == 0 && l2[k + 1] == 0 && l2[k] != 1 && l2[k + 4] == 0) { js21 += 1; }
				if ((k == 0 || k == 2) && l3[k + 3] == 1 && l3[k + 5] == 1 && l3[k + 6] != 0 && l3[k + 6] != 1 && l3[k + 2] == 0 && l3[k + 1] == 0 && l3[k] != 1 && l3[k + 4] == 0) { js21 += 1; }
				if ((k == 0 || k == 2) && l0[k + 3] == 2 && l0[k + 5] == 2 && l0[k + 6] != 0 && l0[k + 6] != 2 && l0[k + 2] == 0 && l0[k + 1] == 0 && l0[k + 4] == 0) { js22 += 1; }
				if ((k == 0 || k == 2) && l1[k + 3] == 2 && l1[k + 5] == 2 && l1[k + 6] != 0 && l1[k + 6] != 2 && l1[k + 2] == 0 && l1[k + 1] == 0 && l1[k + 4] == 0) { js22 += 1; }
				if ((k == 0 || k == 2) && l2[k + 3] == 2 && l2[k + 5] == 2 && l2[k + 6] != 0 && l2[k + 6] != 2 && l2[k + 2] == 0 && l2[k + 1] == 0 && l2[k + 4] == 0) { js22 += 1; }
				if ((k == 0 || k == 2) && l3[k + 3] == 2 && l3[k + 5] == 2 && l3[k + 6] != 0 && l3[k + 6] != 2 && l3[k + 2] == 0 && l3[k + 1] == 0 && l3[k + 4] == 0) { js22 += 1; }

}
	}
	if (color == 1) {
		if (l51 >= 5) {
			score1 = 1000;
		}
		else if (l52 >= 5 || l62 >= 6) {
			score2 = 1000;
		}
		else if (l41 >= 4 && l51 == 0 && l52 == 0 && l62 == 0) {
			score1 = 999;
		}
		else if (cs41 + sjs41 + mjs41 >= 4 && l51 == 0 && l52 == 0 && l62 == 0) {
			score1 = 999;
		}
		else if (cl31 + jl31 >= 3 && l41 == 0 && cs41 == 0 && sjs41 == 0 && mjs41 == 0 && l42 == 0 && cs42 == 0 && sjs42 == 0 && mjs42 == 0 && l51 == 0 && l52 == 0 && l62 == 0) {
			score1 = 997;
		}
		else if (l52 + l62 >= 5) {
			score2 = 1000;
		}
		else if (l42 >= 4 && l41 == 0 && cs41 == 0 && sjs41 == 0 && mjs41 == 0 && l51 == 0 && l52 == 0 && l62 == 0) {
			score2 = 998;
		}
		else if (cs42 + sjs42 + mjs42 >= 8 && l41 == 0 && cs41 == 0 && sjs41 == 0 && mjs41 == 0 && l51 == 0 && l52 == 0 && l62 == 0) {
			score2 = 998;
		}
		else if (cs42 + sjs42 + mjs42 == 4 && cl32 + jl32 == 3 && cl31 == 0 && jl31 == 0 && cs31 == 0 && js31 == 0 && bjs31 == 0 && jjs31 == 0 && l41 == 0 && l42 == 0 && cs41 == 0 && sjs41 == 0 && mjs41 == 0 && l51 == 0 && l52 == 0 && l62 == 0) {
			score2 = 996;
		}
		else if (cl32 + jl32 >= 6 && cl31 == 0 && jl31 == 0 && cs31 == 0 && js31 == 0 && bjs31 == 0 && jjs31 == 0 && l41 == 0 && l42 == 0 && cs41 == 0 && sjs41 == 0 && mjs41 == 0 && l51 == 0 && l52 == 0 && l62 == 0) {
			score2 = 996;
		}
	}
	else {
		if (l52 >= 5 || l62 >= 6) {
			score2 = 1000;
		}
		else if (l51 >= 5) {
			score1 = 1000;
		}
		else if (l42 >= 4 && l51 == 0 && l52 == 0 && l62 == 0) {
			score2 = 999;
		}
		else if (cs42 + sjs42 + mjs42 >= 4 && l51 == 0 && l52 == 0 && l62 == 0) {
			score2 = 999;
		}
		else if (cl32 + jl32 >= 3 && l41 == 0 && cs41 == 0 && sjs41 == 0 && mjs41 == 0 && l42 == 0 && cs41==0&&cs42 == 0&& sjs41 == 0 && sjs42 == 0 &&mjs41==0&& mjs42 == 0 && l51 == 0 && l52 == 0 && l62 == 0) {
			score2 = 997;
		}
		else if (l51 >= 5) {
			score1 = 1000;
		}
		else if (l41 >= 4 && l42 == 0 && cs42 == 0 && sjs42 == 0 && mjs42 == 0 && l51 == 0 && l52 == 0 && l62 == 0) {
			score1 = 998;
		}
		else if (cs41 + sjs41 + mjs41 >= 8 && l42 == 0 && cs42 == 0 && sjs42 == 0 && mjs42 == 0 && l51 == 0 && l52 == 0 && l62 == 0) {
			score1 = 998;
		}
		else if (cs41 + sjs41 + mjs41 == 4 && cl31 + jl31 == 3 && cl32 == 0 && jl32 == 0 && cs32 == 0 && js32 == 0 && bjs32 == 0 && jjs32 == 0 && l41 == 0 && l42 == 0 && cs42 == 0 && sjs42 == 0 && mjs42 == 0 && l51 == 0 && l52 == 0 && l62 == 0) {
			score1 = 996;
		}
		else if (cl31 + jl31 >= 6 && cl32 == 0 && jl32 == 0 && cs32 == 0 && js32 == 0 && bjs32 == 0 && jjs32 == 0 && l41 == 0 && l42 == 0 && cs41 == 0 && cs42 == 0&& sjs41 == 0 && sjs42 == 0&& mjs41 == 0 && mjs42==0&&l51 == 0 && l52 == 0 && l62 == 0) {
			score1 = 996;
		}
	}
	if (score1 == 0 && score2 == 0) {
			score1 += cs41 * 125 / 4;
			score1 += sjs41 * 125 / 4;
			score1 += mjs41 * 125 / 4;
			score2 += cs42 * 125 / 4;
			score2 += sjs42 * 125 / 4;
			score2 += mjs42 * 125 / 4;
			score1 += cl31 * 90 / 3;
			score1 += jl31 * 110 / 3;
			score2 += cl32 * 90/3;
			score2 += jl32 * 110/3;
			score1 += cs31 * 25 / 3;
			score1 += js31 * 25 / 3;
			score1 += bjs31 * 25 / 3;
			score1 += jjs31 * 25 / 3;
			score2 += cs32 * 25/3;
			score2 += js32 * 25/3;
			score2 += bjs32 * 25/3;
			score2 += jjs32 * 25/3;
			score1 += cl21 * 22/2;
			score1 += jl21 * 20 / 2;
			score1 += bjl21 * 18/2;
			score2 += cl22 *22/2;
			score2 += jl22 * 20/2;
			score2 += bjl22 * 18/2;
			score1 += cs21 * 5 / 2;
			score1 += js21 * 5 / 2;
			score2 += cs22 * 5 / 2;
			score2 += js22 * 5 / 2;
			score1 += l11 * 4;
			score1 += s11;
			score2 += l12 * 4;
			score2 += s12;
			if (color == 1) { 
				score1 += 20; 
			}
			else {
				score2 += 20;
			}
		}
	if (color == 1) {
		return score1 - score2;
	}
	else {
		return score2 - score1;
	}
}

function standard(pos,color){
	if(color==1){
  var T = chessBox[pos];
	chessBox[pos] = 1;
  l61 = 0;
	 l51 = 0;
	 l41 = 0;
	 cs41 = 0;
	 sjs41 = 0;
	 mjs41 = 0;
	 cl31 = 0;
	 jl31 = 0;
   x=Math.floor(pos/15);y=pos%15
   l0 = [ -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1 ];
		l1 = [ -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1 ];
		l2 = [ -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1 ];
		l3= [ -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1 ];
		for (var k = 0; k < 11; k++) {
			if (0 <= x - 5 + k && x - 5 + k < 15) {
				l0[k] = chessBox[15*(x - 5+k) + y];
			}
			if (0 <= x - 5 + k && x - 5 + k < 15 && 0 <= y - 5 + k && y - 5 + k < 15) {
				l1[k] = chessBox[15*(x - 5 + k)+y - 5 + k];
			}
			if (0 <= y - 5 + k && y - 5 + k < 15) {
				l2[k] = chessBox[15*x+y - 5 + k];
			}
			if (0 <= x + 5 - k && x + 5 - k < 15 && 0 <= y - 5 + k && y- 5 + k < 15) {
				l3[k] = chessBox[15*(x + 5 - k)+y - 5 + k];
			}
		}
    for ( var k = 0; k < 6; k++) {
			if (k != 5 && l0[k + 1] == 1 && l0[k + 2] == 1 && l0[k + 3] == 1 && l0[k + 4] == 1 && l0[k + 5] == 1 && l0[k] == 1 ) { l61 += 1; }
			if (k != 5 && l1[k + 1] == 1 && l1[k + 2] == 1 && l1[k + 3] == 1 && l1[k + 4] == 1 && l1[k + 5] == 1 && l1[k] == 1 ) { l61 += 1; }
			if (k != 5 && l2[k + 1] == 1 && l2[k + 2] == 1 && l2[k + 3] == 1 && l2[k + 4] == 1 && l2[k + 5] == 1 && l2[k] == 1 ) { l61 += 1; }
			if (k != 5 && l3[k + 1] == 1 && l3[k + 2] == 1 && l3[k + 3] == 1 && l3[k + 4] == 1 && l3[k + 5] == 1 && l3[k] == 1 ) { l61 += 1; }
			if (k != 5 && l0[k + 1] == 1 && l0[k + 2] == 1 && l0[k + 3] == 1 && l0[k + 4] == 1 && l0[k + 5] == 1 && l0[k] != 1 && l0[k + 6] != 1) { l51 += 1; }
			if (k != 5 && l1[k + 1] == 1 && l1[k + 2] == 1 && l1[k + 3] == 1 && l1[k + 4] == 1 && l1[k + 5] == 1 && l1[k] != 1 && l1[k + 6] != 1) { l51 += 1; }
			if (k != 5 && l2[k + 1] == 1 && l2[k + 2] == 1 && l2[k + 3] == 1 && l2[k + 4] == 1 && l2[k + 5] == 1 && l2[k] != 1 && l2[k + 6] != 1) { l51 += 1; }
			if (k != 5 && l3[k + 1] == 1 && l3[k + 2] == 1 && l3[k + 3] == 1 && l3[k + 4] == 1 && l3[k + 5] == 1 && l3[k] != 1 && l3[k + 6] != 1) { l51 += 1; }
			if (k != 4 && k != 5 && l0[k + 1] != 1 && l0[k + 2] == 1 && l0[k + 3] == 1 && l0[k + 4] == 1 && l0[k + 5] == 1 && l0[k + 6] != 1) {
				 t = 0; if (l0[k + 1] != 0 || l0[k + 0] == 1) { t += 1; }; if (l0[k + 6] != 0 || l0[k + 7] == 1) { t += 1; }; if (t == 0) { l41 += 1; }; if (t == 1) { cs41 += 1; }
			}
			if (k != 4 && k != 5 && l1[k + 1] != 1 && l1[k + 2] == 1 && l1[k + 3] == 1 && l1[k + 4] == 1 && l1[k + 5] == 1 && l1[k + 6] != 1) {
				 t = 0; if (l1[k + 1] != 0 || l1[k + 0] == 1) { t += 1; }; if (l1[k + 6] != 0 || l1[k + 7] == 1) { t += 1; }; if (t == 0) { l41 += 1; }; if (t == 1) { cs41 += 1; }
			}
			if (k != 4 && k != 5 && l2[k + 1] != 1 && l2[k + 2] == 1 && l2[k + 3] == 1 && l2[k + 4] == 1 && l2[k + 5] == 1 && l2[k + 6] != 1) {
				 t = 0; if (l2[k + 1] != 0 || l2[k + 0] == 1) { t += 1; }; if (l2[k + 6] != 0 || l2[k + 7] == 1) { t += 1; }; if (t == 0) { l41 += 1; }; if (t == 1) { cs41 += 1; }
			}
			if (k != 4 && k != 5 && l3[k + 1] != 1 && l3[k + 2] == 1 && l3[k + 3] == 1 && l3[k + 4] == 1 && l3[k + 5] == 1 && l3[k + 6] != 1) {
				 t = 0; if (l3[k + 1] != 0 || l3[k + 0] == 1) { t += 1; }; if (l3[k + 6] != 0 || l3[k + 7] == 1) { t += 1; }; if (t == 0) { l41 += 1; }; if (t == 1) { cs41 += 1; }
			}
			if (k != 1 && k != 5 && l0[k + 1] == 1 && l0[k + 2] == 1 && l0[k + 3] == 1 && l0[k + 5] == 1 && l0[k + 4] == 0 && l0[k] != 1 && l0[k + 6] != 1) { sjs41 += 1; }
			if (k != 3 && k != 5 && l0[k + 1] == 1 && l0[k + 3] == 1 && l0[k + 4] == 1 && l0[k + 5] == 1 && l0[k + 2] == 0 && l0[k] != 1 && l0[k + 6] != 1) { sjs41 += 1; }
			if (k != 2 && k != 5 && l0[k + 1] == 1 && l0[k + 2] == 1 && l0[k + 4] == 1 && l0[k + 5] == 1 && l0[k + 3] == 0 && l0[k] != 1 && l0[k + 6] != 1) { mjs41 += 1; }
			if (k != 1 && k != 5 && l1[k + 1] == 1 && l1[k + 2] == 1 && l1[k + 3] == 1 && l1[k + 5] == 1 && l1[k + 4] == 0 && l1[k] != 1 && l1[k + 6] != 1) { sjs41 += 1; }
			if (k != 3 && k != 5 && l1[k + 1] == 1 && l1[k + 3] == 1 && l1[k + 4] == 1 && l1[k + 5] == 1 && l1[k + 2] == 0 && l1[k] != 1 && l1[k + 6] != 1) { sjs41 += 1; }
			if (k != 2 && k != 5 && l1[k + 1] == 1 && l1[k + 2] == 1 && l1[k + 4] == 1 && l1[k + 5] == 1 && l1[k + 3] == 0 && l1[k] != 1 && l1[k + 6] != 1) { mjs41 += 1; }
			if (k != 1 && k != 5 && l2[k + 1] == 1 && l2[k + 2] == 1 && l2[k + 3] == 1 && l2[k + 5] == 1 && l2[k + 4] == 0 && l2[k] != 1 && l2[k + 6] != 1) { sjs41 += 1; }
			if (k != 3 && k != 5 && l2[k + 1] == 1 && l2[k + 3] == 1 && l2[k + 4] == 1 && l2[k + 5] == 1 && l2[k + 2] == 0 && l2[k] != 1 && l2[k + 6] != 1) { sjs41 += 1; }
			if (k != 2 && k != 5 && l2[k + 1] == 1 && l2[k + 2] == 1 && l2[k + 4] == 1 && l2[k + 5] == 1 && l2[k + 3] == 0 && l2[k] != 1 && l2[k + 6] != 1) { mjs41 += 1; }
			if (k != 1 && k != 5 && l3[k + 1] == 1 && l3[k + 2] == 1 && l3[k + 3] == 1 && l3[k + 5] == 1 && l3[k + 4] == 0 && l3[k] != 1 && l3[k + 6] != 1) { sjs41 += 1; }
			if (k != 3 && k != 5 && l3[k + 1] == 1 && l3[k + 3] == 1 && l3[k + 4] == 1 && l3[k + 5] == 1 && l3[k + 2] == 0 && l3[k] != 1 && l3[k + 6] != 1) { sjs41 += 1; }
			if (k != 2 && k != 5 && l3[k + 1] == 1 && l3[k + 2] == 1 && l3[k + 4] == 1 && l3[k + 5] == 1 && l3[k + 3] == 0 && l3[k] != 1 && l3[k + 6] != 1) { mjs41 += 1; }
			if (k != 3 && k != 4 && k != 5 && l0[k + 3] == 1 && l0[k + 4] == 1 && l0[k + 5] == 1 && l0[k + 2] != 1 && l0[k + 6] != 1 && (l0[k + 1] != 1 || (l0[k + 2] != 0 && l0[k + 2] != 1)) && (l0[k + 7] != 1 || (l0[k + 6] != 0 && l0[k + 6] != 1))) {
				 t = 0;  u = 0;
				if (l0[k + 2] != 0 || l0[k + 1] == 1) { t += 1; }
				else if (l0[k + 1] != 0 && l0[k + 1] != 1 || l0[k] == 1) { u += 1; }
				if (l0[k + 6] != 0 || l0[k + 7] == 1) { t += 1; }
				else if (l0[k + 7] != 0 && l0[k + 7] != 1 || l0[k + 8] == 1) { u += 1; }
				if (t == 0 && u <= 1) { cl31 += 1; }
				if ((t == 0 && u == 2) || (t == 1 && u == 0)) { cs31 += 1; }
			}
			if (k != 3 && k != 4 && k != 5 && l1[k + 3] == 1 && l1[k + 4] == 1 && l1[k + 5] == 1 && l1[k + 2] != 1 && l1[k + 6] != 1 && (l1[k + 1] != 1 || (l1[k + 2] != 0 && l1[k + 2] != 1)) && (l1[k + 7] != 1 || (l1[k + 6] != 0 && l1[k + 6] != 1))) {
				 t = 0;  u = 0;
				if (l1[k + 2] != 0 || l1[k + 1] == 1) { t += 1; }
				else if (l1[k + 1] != 0 && l1[k + 1] != 1 || l1[k] == 1) { u += 1; }
				if (l1[k + 6] != 0 || l1[k + 7] == 1) { t += 1; }
				else if (l1[k + 7] != 0 && l1[k + 7] != 1 || l1[k + 8] == 1) { u += 1; }
				if (t == 0 && u <= 1) { cl31 += 1; }
				if ((t == 0 && u == 2) || (t == 1 && u == 0)) { cs31 += 1; }
			}
			if (k != 3 && k != 4 && k != 5 && l2[k + 3] == 1 && l2[k + 4] == 1 && l2[k + 5] == 1 && l2[k + 2] != 1 && l2[k + 6] != 1 && (l2[k + 1] != 1 || (l2[k + 2] != 0 && l2[k + 2] != 1)) && (l2[k + 7] != 1 || (l2[k + 6] != 0 && l2[k + 6] != 1))) {
				 t = 0;  u = 0;
				if (l2[k + 2] != 0 || l2[k + 1] == 1) { t += 1; }
				else if (l2[k + 1] != 0 && l2[k + 1] != 1 || l2[k] == 1) { u += 1; }
				if (l2[k + 6] != 0 || l2[k + 7] == 1) { t += 1; }
				else if (l2[k + 7] != 0 && l2[k + 7] != 1 || l2[k + 8] == 1) { u += 1; }
				if (t == 0 && u <= 1) { cl31 += 1; }
				if ((t == 0 && u == 2) || (t == 1 && u == 0)) { cs31 += 1; }
			}
			if (k != 3 && k != 4 && k != 5 && l3[k + 3] == 1 && l3[k + 4] == 1 && l3[k + 5] == 1 && l3[k + 2] != 1 && l3[k + 6] != 1 && (l3[k + 1] != 1 || (l3[k + 2] != 0 && l3[k + 2] != 1)) && (l3[k + 7] != 1 || (l3[k + 6] != 0 && l3[k + 6] != 1))) {
				 t = 0;  u = 0;
				if (l3[k + 2] != 0 || l3[k + 1] == 1) { t += 1; }
				else if (l3[k + 1] != 0 && l3[k + 1] != 1 || l3[k] == 1) { u += 1; }
				if (l3[k + 6] != 0 || l3[k + 7] == 1) { t += 1; }
				else if (l3[k + 7] != 0 && l3[k + 7] != 1 || l3[k + 8] == 1) { u += 1; }
				if (t == 0 && u <= 1) { cl31 += 1; }
				if ((t == 0 && u == 2) || (t == 1 && u == 0)) { cs31 += 1; }
			}
			if (k != 1 && k != 4 && k != 5 && l0[k + 2] == 1 && l0[k + 3] == 1 && l0[k + 5] == 1 && l0[k + 4] == 0 && l0[k + 1] != 1 && l0[k + 6] != 1) {
				 t = 0;
				if (l0[k + 1] != 0 || l0[k] == 1) { t += 1; }
				if (l0[k + 6] != 0 || l0[k + 7] == 1) { t += 1; }
				if (t == 0) { jl31 += 1; }
				if (t == 1) { js31 += 1; }
			}
			if (k != 2 && k != 4 && k != 5 && l0[k + 2] == 1 && l0[k + 4] == 1 && l0[k + 5] == 1 && l0[k + 3] == 0 && l0[k + 1] != 1 && l0[k + 6] != 1) {
				 t = 0;
				if (l0[k + 1] != 0 || l0[k] == 1) { t += 1; }
				if (l0[k + 6] != 0 || l0[k + 7] == 1) { t += 1; }
				if (t == 0) { jl31 += 1; }
				if (t == 1) { js31 += 1; }
			}
			if (k != 1 && k != 4 && k != 5 && l1[k + 2] == 1 && l1[k + 3] == 1 && l1[k + 5] == 1 && l1[k + 4] == 0 && l1[k + 1] != 1 && l1[k + 6] != 1) {
				 t = 0;
				if (l1[k + 1] != 0 || l1[k] == 1) { t += 1; }
				if (l1[k + 6] != 0 || l1[k + 7] == 1) { t += 1; }
				if (t == 0) { jl31 += 1; }
				if (t == 1) { js31 += 1; }
			}
			if (k != 2 && k != 4 && k != 5 && l1[k + 2] == 1 && l1[k + 4] == 1 && l1[k + 5] == 1 && l1[k + 3] == 0 && l1[k + 1] != 1 && l1[k + 6] != 1) {
				 t = 0;
				if (l1[k + 1] != 0 || l1[k] == 1) { t += 1; }
				if (l1[k + 6] != 0 || l1[k + 7] == 1) { t += 1; }
				if (t == 0) { jl31 += 1; }
				if (t == 1) { js31 += 1; }
			}
			if (k != 1 && k != 4 && k != 5 && l2[k + 2] == 1 && l2[k + 3] == 1 && l2[k + 5] == 1 && l2[k + 4] == 0 && l2[k + 1] != 1 && l2[k + 6] != 1) {
				 t = 0;
				if (l2[k + 1] != 0 || l2[k] == 1) { t += 1; }
				if (l2[k + 6] != 0 || l2[k + 7] == 1) { t += 1; }
				if (t == 0) { jl31 += 1; }
				if (t == 1) { js31 += 1; }
			}
			if (k != 2 && k != 4 && k != 5 && l2[k + 2] == 1 && l2[k + 4] == 1 && l2[k + 5] == 1 && l2[k + 3] == 0 && l2[k + 1] != 1 && l2[k + 6] != 1) {
				 t = 0;
				if (l2[k + 1] != 0 || l2[k] == 1) { t += 1; }
				if (l2[k + 6] != 0 || l2[k + 7] == 1) { t += 1; }
				if (t == 0) { jl31 += 1; }
				if (t == 1) { js31 += 1; }
			}
			if (k != 1 && k != 4 && k != 5 && l3[k + 2] == 1 && l3[k + 3] == 1 && l3[k + 5] == 1 && l3[k + 4] == 0 && l3[k + 1] != 1 && l3[k + 6] != 1) {
				 t = 0;
				if (l3[k + 1] != 0 || l3[k] == 1) { t += 1; }
				if (l3[k + 6] != 0 || l3[k + 7] == 1) { t += 1; }
				if (t == 0) { jl31 += 1; }
				if (t == 1) { js31 += 1; }
			}
			if (k != 2 && k != 4 && k != 5 && l3[k + 2] == 1 && l3[k + 4] == 1 && l3[k + 5] == 1 && l3[k + 3] == 0 && l3[k + 1] != 1 && l3[k + 6] != 1) {
				 t = 0;
				if (l3[k + 1] != 0 || l3[k] == 1) { t += 1; }
				if (l3[k + 6] != 0 || l3[k + 7] == 1) { t += 1; }
				if (t == 0) { jl31 += 1; }
				if (t == 1) { js31 += 1; }
			}
		}
    chessBox[pos] = T;
  	if (l61 >= 1 && l51 == 0) { return true; }
	  if (l41 + cs41 + sjs41 + mjs41 >= 2 && l51 == 0) { return true; }
	  if (cl31 + jl31 >= 2 && l51 == 0) { return true; }
	  return false
	}
	  return false
}
var rangen=[1,-1,2,-2,3,-3]
  function movelist(color){
		var ml=[]
		for(var i=0;i<l.length;i++){
			var x=Math.floor(l[i]/15);var y=l[i]%15
			for(var N=0;N<rangen.length;N++){
				var n=rangen[N]
			if(0<=x+n&&x+n<15){
			if(!ml.includes(15*(x+n)+y)&&!l.includes(15*(x+n)+y)&&!standard(15*(x+n)+y,color)){
				ml.push(15*(x+n)+y)
			}
			}
			if(0<=x+n&&x+n<15&&0<=y+n&&y+n<15){
			if(!ml.includes(15*(x+n)+y+n)&&!l.includes(15*(x+n)+y+n)&&!standard(15*(x+n)+y+n,color)){
				ml.push(15*(x+n)+y+n)
			}
			}
			if(0<=y+n&&y+n<15){
			if(!ml.includes(15*x+y+n)&&!l.includes(15*x+y+n)&&!standard(15*x+y+n,color)){
				ml.push(15*x+y+n)
			}
			}
			if(0<=x-n&&x-n<15&&0<=y+n&&y+n<15){
			if(!ml.includes(15*(x-n)+y+n)&&!l.includes(15*(x-n)+y+n)&&!standard(15*(x-n)+y+n,color)){
				ml.push(15*(x-n)+y+n)
			}
			}
		}
		}
		return ml
	}
function search(color, depth, alpha, beta) {
	var ffp=false
	A+=1
	if (depth <= 0||score>=1000||score<=-1000) {
		return value(color)
	}
	l.push(-1)
	val=-search(3-color,depth-3,-beta,-beta+1)
	l.pop()
	if(val>=beta){
		return beta
	}
	var ML=movelist(color)
	for (var I=0;I<ML.length;I++){
			var i=ML[I]
			chessBox[i]=color
			l.push(i)
			if(ffp){
				var score=-search(3-color,depth-1,-alpha-1,-alpha)
				if(score>alpha&&score<beta){
					var score = -search(3-color, depth - 1, -beta, -alpha)
				}
			}
			else{
				var score = -search(3-color, depth - 1, -beta, -alpha)
			}
    		chessBox[i] = 0;
			l.pop()
			if (score >= beta) {
				return beta;
        	}
			if (score > alpha) {
				
				var alpha = score
				var bestmove =i
				ffp=true
    		}
	}
	if(depth==D){return [alpha,bestmove]};
	return alpha;
  }
function createOption(text) {
  var opt = document.createElement("option")
  opt.selected = true
  opt.text = text
  return opt
}
function drawChessBoard(){
  for(var i=0;i<=14;i++){
  for(a=0;a<=1;a++)
   {
    context.moveTo(15+i*60,15)
    context.lineTo(15+i*60,855)
    context.stroke()
    context.moveTo(15,15+i*60)
    context.lineTo(855,15+i*60)
    context.stroke()}
   }
 }
drawChessBoard()
function oneStep(i,k){
  if(!l.includes(i)){
  l.push(i)
  if(l.length%2==0){white.push(i)}
  if(l.length%2==1){black.push(i)}
  selMoveList.add(createOption(color[l.length%2]+l.length.toString()+':'+name(i)))
  context.beginPath()
  context.arc(15+Math.floor(i/15)*60,855-i%15*60,26,0,2*Math.PI)
  
  var g=context.createRadialGradient(15+Math.floor(i/15)*60,855-i%15*60,26,15+Math.floor(i/15)*60,855-i%15*60,0)
  if(k){g.addColorStop(0,'#0A0A0A');g.addColorStop(1,'#636766');chessBox[i]=1}
  else{g.addColorStop(0,'#D1D1D1');g.addColorStop(1,'#F9F9F9');chessBox[i]=2}
  context.fillStyle=g
  context.fill()
  if(k){context.fillStyle='white'}
  else{context.fillStyle='black'}
  if(l.length<=9){context.fillText(l.length,12+Math.floor(i/15)*60,859-i%15*60)}
  if(10<=l.length&&l.length<=99){context.fillText(l.length,9+Math.floor(i/15)*60,859-i%15*60)}
  if(100<=l.length){context.fillText(l.length,6+Math.floor(i/15)*60,859-i%15*60)}
  context.closePath()
  me=!me
 }}
chess.onclick=function(e){
  var x = e.offsetX
  var y = 855-e.offsetY
  var i = Math.round(x/60)
  var j = Math.round(y/60)
  if(i>=0&&i<=14&&j>=0&&j<=14){oneStep(i*15+j,me)}}
function retract()
{
	if(l.length!=0){
  var i=l[l.length-1]
  chessBox[i]=0
  context.clearRect(Math.floor(i/15)*60-15,825-i%15*60,60,60)
  context.beginPath()
  for(a=0;a<=1;a++)
  {
    context.moveTo(Math.floor(i/15)*60+15,Math.max(825-i%15*60,15))
    context.lineTo(Math.floor(i/15)*60+15,Math.min(885-i%15*60,855))
    context.stroke()
    context.moveTo(Math.max(Math.floor(i/15)*60-15,15),855-i%15*60)
    context.lineTo(Math.min(Math.floor(i/15)*60+45,855),855-i%15*60)
    context.stroke()
  }
  me=!me
  l.pop()
  if(l.length%2==0){black.pop()}
  if(l.length%2==1){white.pop()}
}
}
function newgame(){var t=l.length;for(i=0;i<t;i++){retract()};if(check0.checked){solve()}}
function T(i,d){if(d==0){return i};if(d==1){return 210-i%15*15+Math.floor(i/15)};if(d==2){return 224-i};if(d==3){return i%15*15+14-Math.floor(i/15)};if(d==4){return 210-i+i%15*2};if(d==5){i%15*15+Math.floor(i/15)};if(d==6){14+i-i%15*2};if(d==7){return 224-i%15*15-Math.floor(i/15)}}
function Tlist(list,d){var tlist=[];for(i=0;i<list.length;i++){tlist.push(T(list[i],d))};return tlist}
function deeping(){
  var find=false
  var findlist=[[[],[],112],[[112],[],113],[[112],[113],128],[[112],[128],126],
  [[112,126],[98,128],141],[[112,126],[110,128],98],[[112,126],[128,143],98],
  //浦月黑3
  [[112,126],[128],98],
  //银月黑3
  [[111,112],[128],113],
  //银月白4
  [[111,112],[113,128],98],
  //斜月黑3
  [[96,112],[128],127],
  //丘月黑3
  [[112,126],[113],98],
  //疏星黑3
  [[112,144],[113],128],
  //花月白4
  [[112,128],[113,127],141], [[112,128],[96,113],144],[[112,128],[113,144],96],
  //花月白4:I8白6
  [[112,128,141],[96,113,127],156],[[112,128,141],[111,113,127],144],[[112,128,141],[113,126,127],144],[[112,128,141],[113,127,140],144],[[112,128,141],[113,127,142],96],[[112,128,141],[113,127,143],96],[[112,128,141],[113,127,144],140],[[112,128,141],[113,127,156],96],
  //花月白4:G7白6
  [[112,128,144],[96,113,160],142],[[112,128,144],[96,113,127],129],
  [[98,112,126],[128,140,143],114],[[112,126,141],[98,128,143],113],[[112,126,141],[97,98,128],143],[[112,126,141],[98,113,128],143],[[112,126,141],[98,111,128],142],[[112,126,141],[98,128,158],143],
  [[112,113,126,141],[98,111,128,143],127],[[112,113,126,141],[98,127,128,143],110],[[110,112,113,126,141],[98,111,127,128,143],95]]
  for(j=0;j<findlist.length;j++){for(d=0;d<8;d++){if(same(black,Tlist(findlist[j][0],d))&&same(white,Tlist(findlist[j][1],d))){oneStep(T(findlist[j][2],d),me);var find=true;break}};if(find==true){break}}
  if(find){selMoveList.add(createOption(color[l.length%2]+l.length.toString()+':find'))}
  else{
	var deep=4
	for(D=2;D<=deep;D+=2){
	A=0
      if(me){Bestmove=search(1,D,-1001,1001)
      }
      else{
        Bestmove=search(2,D,-1001,1001)
      }
	  if(Bestmove[0]>=775){
		selMoveList.add(createOption('着法:'+name(Bestmove[1])+',分数:'+(Bestmove[0]+1-D)+',深度:'+D+',节点数:'+A))
		break
	}
	  else if(Bestmove[0]<=-775){
		selMoveList.add(createOption('着法:'+name(Bestmove[1])+',分数:'+(Bestmove[0]-1+D)+',深度:'+D+',节点数:'+A))
		break
	}
	  else{
		selMoveList.add(createOption('着法:'+name(Bestmove[1])+',分数:'+Bestmove[0]+',深度:'+D+',节点数:'+A))
	  }
    }
	oneStep(Bestmove[1],me);
}
    }
</script>
</html>
